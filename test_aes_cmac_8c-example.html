<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ModularAES: test_aes_cmac.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ModularAES
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('test_aes_cmac_8c-example.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">test_aes_cmac.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Tests from SP800-38B</p>
<div class="fragment"><div class="line"><span class="comment">/* Copyright (c) 2013-2016 Cameron Harper</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * Permission is hereby granted, free of charge, to any person obtaining a copy of</span></div>
<div class="line"><span class="comment"> * this software and associated documentation files (the &quot;Software&quot;), to deal in</span></div>
<div class="line"><span class="comment"> * the Software without restriction, including without limitation the rights to</span></div>
<div class="line"><span class="comment"> * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of</span></div>
<div class="line"><span class="comment"> * the Software, and to permit persons to whom the Software is furnished to do so,</span></div>
<div class="line"><span class="comment"> * subject to the following conditions:</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * The above copyright notice and this permission notice shall be included in all</span></div>
<div class="line"><span class="comment"> * copies or substantial portions of the Software.</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></div>
<div class="line"><span class="comment"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS</span></div>
<div class="line"><span class="comment"> * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR</span></div>
<div class="line"><span class="comment"> * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER</span></div>
<div class="line"><span class="comment"> * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</span></div>
<div class="line"><span class="comment"> * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;unity.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;moda.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;aes.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;aes_cmac.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_128_mlen0(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a0"></a><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0xbb,0x1d,0x69,0x29,0xe9,0x59,0x37,0x28,0x7f,0xa3,0x7d,0x12,0x9b,0x75,0x67,0x46};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a name="a1"></a><a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a name="a2"></a><a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a name="a3"></a><a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2ad8c1d2fb9e872e01f283eb3278714ae2">AES_KEY_128</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a name="a4"></a><a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, NULL, 0U, t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_128_mlen128(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0x07,0x0a,0x16,0xb4,0x6b,0x4d,0x41,0x44,0xf7,0x9b,0xdd,0x9d,0xd0,0x4a,0x28,0x7c};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2ad8c1d2fb9e872e01f283eb3278714ae2">AES_KEY_128</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_128_mlen320(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11 };</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0xdf,0xa6,0x67,0x47,0xde,0x9a,0xe6,0x30,0x30,0xca,0x32,0x61,0x14,0x97,0xc8,0x27};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2ad8c1d2fb9e872e01f283eb3278714ae2">AES_KEY_128</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_128_mlen512(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0x51,0xf0,0xbe,0xbf,0x7e,0x3b,0x9d,0x92,0xfc,0x49,0x74,0x17,0x79,0x36,0x3c,0xfe};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2ad8c1d2fb9e872e01f283eb3278714ae2">AES_KEY_128</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_192_mlen0(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0xd1,0x7d,0xdf,0x46,0xad,0xaa,0xcd,0xe5,0x31,0xca,0xc4,0x83,0xde,0x7a,0x93,0x67};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a name="a5"></a><a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a03ffabf96649e9731c3ad6bd0fdcb765">AES_KEY_192</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, NULL, 0U, t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_192_mlen128(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0x9e,0x99,0xa7,0xbf,0x31,0xe7,0x10,0x90,0x06,0x62,0xf6,0x5e,0x61,0x7c,0x51,0x84};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a03ffabf96649e9731c3ad6bd0fdcb765">AES_KEY_192</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_192_mlen320(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0x8a,0x1d,0xe5,0xbe,0x2e,0xb3,0x1a,0xad,0x08,0x9a,0x82,0xe6,0xee,0x90,0x8b,0x0e};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a03ffabf96649e9731c3ad6bd0fdcb765">AES_KEY_192</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_192_mlen512(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0xa1,0xd5,0xdf,0x0e,0xed,0x79,0x0f,0x79,0x4d,0x77,0x58,0x96,0x59,0xf3,0x9a,0x11};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a03ffabf96649e9731c3ad6bd0fdcb765">AES_KEY_192</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_256_mlen0(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0x02,0x89,0x62,0xf6,0x1b,0x7b,0xf8,0x9e,0xfc,0x6b,0x55,0x1f,0x46,0x67,0xd9,0x83};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a name="a6"></a><a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a23db44ed3285f4248d3976675a57989a">AES_KEY_256</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, NULL, 0U, t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_256_mlen128(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0x28,0xa7,0x02,0x3f,0x45,0x2e,0x8f,0x82,0xbd,0x4b,0xf2,0x8d,0x8c,0x37,0xc3,0x5c};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a23db44ed3285f4248d3976675a57989a">AES_KEY_256</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_256_mlen320(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0xaa,0xf3,0xd8,0xf1,0xde,0x56,0x40,0xc2,0x32,0xf5,0xb1,0x69,0xb9,0xc9,0x11,0xe6};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a23db44ed3285f4248d3976675a57989a">AES_KEY_256</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> test_MODA_AES_CMAC_256_mlen512(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__moda__aes.html#structaes__ctxt">aes_ctxt</a> aes;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t key[] = {0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t m[] = {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10};</div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t expectedT[] = {0xe1,0x99,0x21,0x90,0x54,0x9f,0x6e,0xd5,0x69,0x6a,0x2c,0x05,0x6c,0x31,0x54,0x10};</div>
<div class="line"></div>
<div class="line">    uint8_t t[<a class="code" href="group__moda__aes.html#gaf19ab913a847ad1e91c5291215116de1">AES_BLOCK_SIZE</a>];</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes.html#gaae1e1bea4adfeb5e6bf0758efc92aac0">MODA_AES_Init</a>(&amp;aes, <a class="code" href="group__moda__aes.html#gga49472bbd482a7e8ed4664a46b0e6f2d2a23db44ed3285f4248d3976675a57989a">AES_KEY_256</a>, key);</div>
<div class="line">    memset(t, 0x0, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__moda__aes__cmac.html#ga89445d88b719ef6d39736a3994213245">MODA_AES_CMAC</a>(&amp;aes, m, <span class="keyword">sizeof</span>(m), t, <span class="keyword">sizeof</span>(t));</div>
<div class="line"></div>
<div class="line">    TEST_ASSERT_EQUAL_MEMORY(expectedT, t, <span class="keyword">sizeof</span>(expectedT));    </div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer"><a href="http://cjh.id.au">cjh.id.au</a></li>
  </ul>
</div>
</body>
</html>
